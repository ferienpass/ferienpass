{% extends "@FerienpassAdmin/layout/list.html.twig" %}
{% trans_default_domain 'admin' %}
{% set translationPrefix = app.request.get('_route')|split('_')[1] %}
{% set action = app.request.get('_route')|split('_')[2] %}
{% import "@FerienpassAdmin/components/content_elements.html.twig" as partials %}

{% block list %}

    {% if 'ROLE_HOST' == role %}
        {% set columns = {
            name: '{{ item.name }}',
            email: '{{ item.email }}',
            hosts: '{{ item.hosts|map(u => "#{u.name}")|join(", ") }}'
        } %}
    {% elseif 'ROLE_MEMBER' == role %}
        {% set columns = {
            name: '{{ item.name }}',
            email: '{{ item.email }}',
            participants: '{{ item.participants|map(u => "#{u.name}")|join(", ") }}'
        } %}
    {% elseif 'ROLE_ADMIN' == role %}
        {% set columns = {
            name: '{{ item.name }}',
            email: '{{ item.email }}',
            roles: '
            {% if "ROLE_SUPER_ADMIN" in item.roles %}
                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">{{ "accounts.td.role.ROLE_SUPER_ADMIN"|trans([], "admin") }}</span>
            {% else %}
            {% for role in item.roles|filter((role) => role in ["ROLE_CMS_ADMIN", "ROLE_PAYMENTS_ADMIN", "ROLE_PARTICIPANTS_ADMIN"]) %}
                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">{{ ("accounts.td.role."~role)|trans([], "admin") }}</span>
            {% endfor %}
            {% endif %}
'
        } %}
    {% endif %}

    {{ component('SearchableQueryableList', { qb: qb, originalRoute: app.request.get('_route'), originalQuery: app.request.query.all,
        searchable: searchable,
        config: {
            columns: columns
        },

    }) }}
{% endblock %}
