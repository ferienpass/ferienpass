{% extends "@FerienpassAdmin/layout/list.html.twig" %}

{% set config = {
    columns: {
        offer: '{{ item.offer.name }}',
        fee: '{{ (item.offer.fee/100)|format_currency("EUR", locale="de") }}',
        status: '
{% import "@FerienpassAdmin/components/content_elements.html.twig" as partials %}

{{ partials.status_badge(item.status, "sm", "-ml-2") }}
'
    }
} %}

{% block headline_actions %}

    <div class="flex items-center space-x-3">

        {{ parent() }}

        {% embed '@FerienpassAdmin/components/dropdown.html.twig' with { dropdownClass: 'w-96'} %}
            {% block toggle %}
                <button type="button"
                        class="relative shadow-sm inline-flex px-4 py-2 items-center border border-transparent text-sm leading-5 font-medium rounded-md focus:outline-none focus:shadow-outline-blue border-transparent text-white bg-primary-600 hover:bg-primary-500 focus:border-primary-700 active:bg-primary-700"
                        id="options-menu-0-button"
                        aria-expanded="false"
                        aria-haspopup="true">
                    <span class="flex items-center space-x-1 -mr-2">
                        <span class="h-5 w-5">{{ source('@FerienpassAdmin/icons/plus-solid.svg') }}</span>
                        <span>Neu anlegen…</span>
                        <span class="h-5 w-5">{{ source('@FerienpassAdmin/icons/chevron-down-solid.svg') }}</span>
                    </span>
                </button>
            {% endblock %}

            {% block dropdown %}

                <div class="px-4 py-2">

                    {{ form(add) }}

                </div>

            {% endblock %}

        {% endembed %}

    </div>

{% endblock %}

{% block ms_select_all_checkbox %}
    <script>
        function selectAllCustom(e) {
            if (this.$el.checked && (this.selected.length > 0 || {{ items|filter(i => i.status == 'confirmed')|length ? 'false' : 'true' }})) {
                this.selected = [{{ items|map(i => "#{i.id}")|join(', ') }}];
            } else if (this.$el.checked) {
                this.selected = [{{ items|filter(i => i.status == 'confirmed')|map(i => "#{i.id}")|join(', ') }}];
                this.$el.checked = false;
            } else {
                console.log('a');
                this.selected = [];
            }
        }
    </script>
    <input type="checkbox"
           id="cbx_ms_sa"
           @change="selectAllCustom"
           class="focus:ring-primary-500 h-4 w-4 text-primary-600 border-gray-300">
    <label for="cbx_ms_sa" class="sr-only">Alle auswählen</label>
{% endblock %}
